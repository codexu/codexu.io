# ç©¶ç«Ÿä»€ä¹ˆæ˜¯å‰ç«¯è„šæ‰‹æ¶ï¼Ÿ

ğŸ˜” å’±ä¹Ÿä¸çŸ¥é“å’±ä¹Ÿä¸æ•¢é—®å•Š

å…ˆæŸ¥æŸ¥ç™¾åº¦ç™¾ç§‘é‡Œå¯¹â€œè„šæ‰‹æ¶â€çš„å®šä¹‰å§ï¼š

> è„šæ‰‹æ¶æ˜¯ä¸ºäº†ä¿è¯å„æ–½å·¥è¿‡ç¨‹é¡ºåˆ©è¿›è¡Œè€Œæ­è®¾çš„å·¥ä½œå¹³å°ã€‚

ç„¶åæ˜é‡‘é‡Œæœä¸€ä¸‹â€œè„šæ‰‹æ¶â€ï¼ŒåŸºæœ¬ä¸Šéƒ½æ˜¯ä»¥ä¸‹å‡ ç±»ï¼š

- Vue/React è„šæ‰‹æ¶

- ä½¿ç”¨ Nodeã€yeoman æ‰“é€ è‡ªå·±çš„è„šæ‰‹æ¶

- ä»é›¶æ­å»º webpack è„šæ‰‹æ¶

æ­¤æ—¶è¿˜æ˜¯æ— æ³•ç¡®å®šä»€ä¹ˆæ˜¯â€œè„šæ‰‹æ¶â€ï¼Œä¹Ÿè®¸æˆ‘å¿ƒç›®ä¸­çš„è„šæ‰‹æ¶åº”è¯¥æ˜¯ vue/cli æˆ–è€… create-react-app å§ï¼Œç„¶åæˆ‘æ‰“å¼€ä»–ä»¬çš„æ–‡æ¡£ï¼Œä½†æ˜¯ä»–ä»¬çš„ä»‹ç»ä¸Šå¹¶æ²¡æœ‰è¯´è¿™æ˜¯ä¸€æ¬¾è„šæ‰‹æ¶...

## è°ˆä¸€ä¸‹æˆ‘è‡ªå·±çš„â€œè„šæ‰‹æ¶â€

ğŸ˜” æˆ‘æœ€æ€•åˆ«äººçœ‹åˆ°æˆ‘çš„â€œè„šæ‰‹æ¶â€åè¯´è¿™æœ‰ä»€ä¹ˆåµç”¨...

çœ‹äº†ä¸€ä¸‹æˆ‘ç¬¬ä¸€æ¬¡åœ¨ Github ä¸Šçš„æäº¤è®°å½• Commits on Feb 13, 2017ï¼Œæˆ‘å…¥è¡Œä¸‰å¹´å¤šï¼Œé‚£æ—¶åº”è¯¥æ˜¯æˆ‘ç¬¬ä¸€æ¬¡è¿›å…¥å‰ç«¯å·¥ç¨‹åŒ–çš„æ—¶å€™å§ã€‚åœ¨æ­¤ä¹‹å‰æˆ‘åœ¨å…¬å¸æ¥æ‰‹çš„éƒ½æ˜¯ä¸€äº›å¾ˆç®€å•çš„é¡¹ç›®ï¼Œç›´æ¥æ–°å»ºæ–‡ä»¶å¤¹ï¼Œéšæ‰‹ä¸‹è½½ä¸€ä¸ªjQueryï¼Œç„¶åæ–°å»º index.html main.js style.cssï¼Œæœ‰æ²¡æœ‰åŒæ ·ç»å†çš„å°ä¼™ä¼´ä»¬ï¼Ÿ

åæ¥åšçš„é¡¹ç›®å¤šäº†ï¼Œè§‰å¾—æ¯æ¬¡è¿™ä¹ˆæ–°å»ºé¡¹ç›®å¤ªéº»çƒ¦ï¼Œæˆ‘æ–°å»ºäº†ä¸€ä¸ªæ–‡ä»¶å¤¹ï¼Œä¸“é—¨å­˜æ”¾åˆå§‹çš„æ¨¡æ¿ï¼Œç„¶åå¤åˆ¶ç²˜è´´ï¼Œç»§ç»­æ’¸ã€‚

å†åæ¥ï¼Œæ¥è§¦åˆ° vueï¼Œä»–å¯ä»¥å®ç°åœ¨ç»ˆç«¯å†…è¾“å…¥ä¸€è¡ŒæŒ‡ä»¤å°±èƒ½ç”Ÿæˆæ¨¡æ¿ï¼Œè¿™å¯æ¯”æˆ‘å¤åˆ¶ç²˜è´´çœ‹èµ·æ¥é«˜ç«¯å¤šäº†ï¼Œä¸ºäº†è£…é€¼æˆ‘å¼€å§‹äº†ç ”ç©¶å¦‚ä½•å¼€å‘è‡ªå·±çš„â€œè„šæ‰‹æ¶â€ã€‚

å½“æ—¶è¿˜çœŸæ˜¯æ²¡æœ‰å‡ ç¯‡æ–‡ç« æŠŠè¿™ç§æ“ä½œè¯´çš„å¾ˆæ˜ç™½ï¼Œç”šè‡³æˆ‘å¹¶ä¸çŸ¥é“æˆ‘è¦åšçš„ä¸œè¥¿å«ä»€ä¹ˆï¼ˆè„šæ‰‹æ¶ï¼‰ã€‚

## æˆ‘ç†è§£çš„â€œè„šæ‰‹æ¶â€

ğŸ¤“ ç™¾ç§‘é‡Œè¯´çš„å¾ˆå¯¹æˆ‘çš„æ€è·¯ï¼Œé¦–è¦çš„å°±æ˜¯ä¿è¯æˆ‘çš„é¡¹ç›®å¯ä»¥é¡ºåˆ©è¿›è¡Œã€‚

- èƒ½å¤Ÿå¿«é€Ÿå¸®æˆ‘ç”Ÿæˆæ–°é¡¹ç›®çš„ç›®å½•æ¨¡æ¿(Node.js)ã€‚

- èƒ½å¤Ÿæå‡æˆ‘çš„å¼€å‘æ•ˆç‡å’Œå¼€å‘çš„èˆ’é€‚æ€§(webpack)ã€‚

## åˆ†äº«ç‚¹å¹²è´§

ğŸ¤ªæ˜é‡‘æ˜¯ä¸ªåˆ†äº«æŠ€æœ¯çš„åœ°æ–¹ï¼Œæˆ‘ä¸èƒ½è¿™ä¹ˆæ°´ä¸€ç¯‡æ–‡ç« ã€‚

ä»é›¶æ­å»ºè¿™ç§æˆ‘å°±ä¸è¯´äº†ï¼Œæ¯•ç«Ÿä¸€æœä¸€å †ï¼ŒåŸºæœ¬ä¸Šå°±æ˜¯æ¨èå‡ ä¸ªåº“ï¼Œä¾‹å¦‚ commanderã€inquirerã€ora ç­‰ç­‰ã€‚åˆ†äº«ä¸€äº›åœ¨æˆ‘çš„è„šæ‰‹æ¶å¼€å‘æ—¶é‡åˆ°çš„ä¸€äº›é—®é¢˜å’Œéœ€æ±‚ï¼Œåˆ†äº«æƒ³ç»™å¤§å®¶ã€‚

### ç‰ˆæœ¬éªŒè¯

é¦–å…ˆæ¨èå·¥å…·åº“ï¼š

[semver](https://www.npmjs.com/package/semver)ï¼Œç‰ˆæœ¬å¯¹æ¯”ã€‚

[request](https://www.npmjs.com/package/semver)ï¼Œå‘é€è¯·æ±‚ï¼Œå½“ç„¶ä½ ä¹Ÿå¯ä»¥ç”¨ axiosã€‚

```javascript
const semver = require('semver');
const request = require('request');
```

- Node.js ç‰ˆæœ¬éªŒè¯

å¦‚æœä½ çš„è„šæ‰‹æ¶æƒ³åˆ†äº«ç»™åˆ«äººç”¨ï¼Œè¿™æ­¥æœ€å¥½ä¸è¦é¿å…ï¼Œå› ä¸ºå¦‚æœä½ ç”¨äº†ä¸€äº›ç°ä»£åŒ–çš„ ES è¯­æ³•ï¼Œæ¯”å¦‚è¯´ async awaitï¼Œè€ç‰ˆæœ¬è·‘ä¸èµ·æ¥çš„ã€‚

```javascript
function checkNodeVersion (wanted) {
  // process.version å¯ä»¥è·å–å½“å‰çš„ node ç‰ˆæœ¬
  if (!semver.satisfies(process.version, wanted)) {
    console.log('Nodeç‰ˆæœ¬ä¸æ”¯æŒå·´æ‹‰å·´æ‹‰');
    // é€€å‡ºè¿›ç¨‹
    process.exit(1);
  }
}
```

- è„šæ‰‹æ¶ç‰ˆæœ¬éªŒè¯

æ­£å¦‚ä¸Šé¢æ‰€è¯´ï¼Œä½ å¦‚æœåˆ†äº«ç»™åˆ«äººç”¨ï¼Œåœ¨ä½ ä¿®æ”¹äº†ä¸€äº› bug åï¼Œå¸Œæœ›å…¶ä»–äººç”¨æœ€æ–°çš„ç‰ˆæœ¬ï¼Œé‚£å°±åº”è¯¥æç¤ºä»–ã€‚

```javascript
function checkPackageVersion(url) {
  return new Promise((resolve, reject) => {
    request(url, function (error, response, body) {
      if (!error && response.statusCode === 200){
        let version = JSON.parse(body).version;
        if (semver.lte(version, requiredVersion)) {
          resolve();
        } else {
          console.log('éœ€è¦æ›´æ–°ä½ çš„åŒ…å·´æ‹‰å·´æ‹‰');
          process.exit(1);
        }
      } else {
        console.log('å‘é€è¯·æ±‚å¤±è´¥å·´æ‹‰å·´æ‹‰');
        resolve();
      }
    });
  });
}
```

å‚æ•° url å½“ç„¶ä¼ å…¥ npm çš„é“¾æ¥ https://registry.npmjs.org/[ä½ çš„åŒ…å]/latest

### å½“å‰è·¯å¾„ä¸‹æ˜¯å¦å­˜åœ¨ç›¸åŒçš„æ–‡ä»¶å¤¹

å¦‚æœä¸åšè¿™å±‚åˆ¤æ–­ï¼Œä½ æ–°ç”Ÿæˆçš„é¡¹ç›®å¾ˆå¯èƒ½ä¼šè¦†ç›–ä½ å·²æœ‰çš„é¡¹ç›®ï¼Œåˆ«é—®æˆ‘ä¸ºå•¥æƒ³åˆ°è¿™ä¹ˆåš ğŸ˜­

```JavaScript
function hasFolder(name) {
  return new Promise (resolve => {
    fs.exists(name, exists => {
      if (exists) {
        console.log('å·²ç»å­˜åœ¨ç›¸åŒç›®å½•å·´æ‹‰å·´æ‹‰');
        process.exit(1);
      } else {
        resolve();
      }
    });
  });
};
```

è¿™é‡ŒåŠ äº†ä¸€å±‚ Promise æ˜¯å› ä¸º Node å»æ£€æµ‹æ˜¯å¦å­˜åœ¨æ–‡ä»¶å¤¹æ˜¯ä¸ªå¼‚æ­¥æ“ä½œï¼Œä¹Ÿéœ€è¦è€—æ—¶ï¼Œè¿™ä¹ˆåšæ¯”è¾ƒä¿é™©ã€‚

### æ¸…ç©ºæ§åˆ¶å°

å½“ä½ è¾“å…¥å®Œå‘½ä»¤åï¼Œå¥½åƒè¿›å…¥äº†æ–°çš„é¡µé¢ä¸€æ ·ï¼Œçœ‹èµ·æ¥å¾ˆèˆ’æœã€‚

```javascript
function clearConsole(color, str) {
  if (process.stdout.isTTY && store.cmd !== 'test') {
    const blank = '\n'.repeat(process.stdout.rows);
    console.log(blank);
    readline.cursorTo(process.stdout, 0, 0);
    readline.clearScreenDown(process.stdout);
  }
}
```

### æ‹·è´æ¨¡æ¿

å¾ˆå¤šå…³äºå¦‚æœæ„å»ºè„šæ‰‹æ¶é‡Œæåˆ°ä¸€ä¸ªå·¥å…· download-git-repoï¼Œåœ¨ github æˆ–å…¶ä»–ä»“åº“ä¸­ä¸‹è½½æ¨¡æ¿ã€‚æˆ‘å¹¶ä¸æ˜¯å¾ˆå–œæ¬¢è¿™ç§æ“ä½œï¼Œ1ã€è€—æ—¶ï¼Œè®©è„šæ‰‹æ¶æ„å»ºé€Ÿåº¦æ›´æ…¢äº†ï¼Œåœ¨æ²¡æœ‰ç½‘ç»œçš„æƒ…å†µä¸‹æ— æ³•æ„å»ºã€‚2ã€åœ¨ git ä»“åº“ä¸­è¿˜éœ€è¦æ–°å»ºé¡¹ç›®æ¨¡æ¿ï¼Œæ„Ÿè§‰æŠŠä¸€ä¸ªé¡¹ç›®åˆ†ç¦»æˆäº†ä¸¤ä¸ªï¼Œä¸æ–¹ä¾¿ç®¡ç†ã€‚

æ‰€ä»¥æˆ‘æ‰“ç®—ç›´æ¥ä»å…¨å±€ç›®å½•ä¸‹å°†æ¨¡æ¿æ–‡ä»¶å¤¹æ‹·è´åˆ°å½“å‰è·¯å¾„ä¸‹ï¼š

ä½¿ç”¨ä¸€ä¸ªå·¥å…· [fs-extra](https://www.npmjs.com/package/fs-extra)ï¼Œnode.js æ–°æ‰‹æœ€å¥½ä¸è¦è¯•å›¾ç”¨åŸç”Ÿæ¥å£æ‹·è´ä¸€ä¸ªæ–‡ä»¶å¤¹ã€‚

const src = path.resolve(__dirname, '../template');

const dest = path.resolve(process.cwd(), store.dirname);

ä¸¤ä¸ªæ¦‚å¿µï¼š

å…¨å±€ç¯å¢ƒè·¯å¾„ï¼š

```javascript
const src = path.resolve(__dirname, 'ä½ çš„æ¨¡æ¿æ–‡ä»¶å¤¹ç›¸å¯¹è·¯å¾„'ï¼‰
```

å½“å‰ç¯å¢ƒè·¯å¾„ï¼š

```javascript
const dest = path.resolve(process.cwd(), 'ä½ åˆ›å»ºé¡¹ç›®çš„åç§°');
```

```javascript
  fs.copy(src, dest).then(() => /* å·´æ‹‰å·´æ‹‰ */);
```

### è‡ªåŠ¨é€‰æ‹©åŒ…ç®¡ç†å™¨

ç°åœ¨ç”¨ yarn çš„äººè¶Šæ¥è¶Šå¤šï¼Œè€Œä¸”ç¡®å®æ•ˆç‡å¾ˆé«˜ï¼Œå¦‚æœå®‰è£…è¿‡ yarn å°±è®©å®ƒä½œä¸ºé»˜è®¤åŒ…ç®¡ç†å™¨å»è‡ªåŠ¨å®‰è£…ä¾èµ–å§ã€‚

```javascript
function packageManagement() {
  try {
    child_process.execSync('yarnpkg --version', { stdio: 'ignore' });
    return 'yarn';
  } catch (e) {
    return 'npm';
  }
}
```

### è‡ªåŠ¨å®‰è£…ä¾èµ–

è¿™é‡Œç”¨åˆ° Node.js ä¸­çš„ [child_process.spawn](http://nodejs.cn/api/child_process.html#child_process_child_process_spawn_command_args_options) æ–¹æ³•

è¿™é‡Œä¸¾ä¸ªä¾‹å­ï¼Œæƒ³è¦æ‰§è¡Œ npm install webpack -D

```javascript
const ls = spawn('npm', ['isntall', 'webpack', '-D'], {shell: true});
ls.on('close', (code) => /* å·´æ‹‰å·´æ‹‰ */)
```

- ç¬¬ä¸€ä¸ªå‚æ•°ï¼šè¦è¿è¡Œçš„å‘½ä»¤ã€‚

- ç¬¬äºŒä¸ªå‚æ•°ï¼šæ•°ç»„ï¼Œå­—ç¬¦ä¸²å‚æ•°çš„åˆ—è¡¨ã€‚

- ç¬¬ä¸‰ä¸ªå‚æ•°ï¼šé…ç½®ï¼Œè¿™é‡ŒæŠŠ shell è®¾ç½®ä¸º trueã€‚

- ä½¿ç”¨ on æ–¹æ³•ç›‘å¬æ‰§è¡Œç»“æœã€‚

> è¿™é‡Œæ¨èå®‰è£…çš„åŒ…å¸¦æœ‰ç‰ˆæœ¬å·ï¼Œå¦‚æœç›´æ¥å®‰è£…ä¼šå®‰è£…æœ€æ–°ç‰ˆï¼Œå¯èƒ½ä¼šå¯¼è‡´ä¸å…¼å®¹ã€‚

### æä¸€ä¸ª webpack çš„æ’ä»¶

[ProgressPlugin](https://webpack.docschina.org/plugins/progress-plugin/#src/components/Sidebar/Sidebar.jsx)ï¼Œç”¨äºç›‘å¬ç¼–è¯‘è¿›åº¦ã€‚

```javascript
plugins: [
  new webpack.ProgressPlugin(function(percentage) {
    // percentage è¿›åº¦ 0-1
  })
]
```

è¿™é‡Œé…åˆå‰é¢è¯´åˆ°çš„æ¸…ç©ºæ§åˆ¶å°ï¼Œå¯ä»¥å®ç°æ›´å¥½çš„ä½“éªŒã€‚

### ä½¿ç”¨ IP è®¿é—®é¡¹ç›®

è¿™é‡ŒæŒ‡çš„æ˜¯é€šè¿‡ webpack å¯åŠ¨çš„ devServerã€‚

host é…ç½®ä¸º 0.0.0.0

é€šè¿‡ä¸‹é¢çš„å‡½æ•°è·å–åˆ°æœ¬æœºçš„ IP åœ°å€ï¼Œè¿™æ ·å°±å¯ä»¥åœ¨åŒç½‘ä¸‹ä½¿ç”¨ç§»åŠ¨è®¾å¤‡åšæµ‹è¯•äº†ã€‚

```javascript
function getIPAdress() {
  let interfaces = require('os').networkInterfaces();
  // eslint-disable-next-line guard-for-in
  for (let devName in interfaces) {
    let iface = interfaces[devName];
    for (let i = 0; i < iface.length; i++) {
      let alias = iface[i];
      if (alias.family === 'IPv4' && alias.address !== '127.0.0.1' && !alias.internal) {
        return alias.address;
      }
    }
  }
}
```

## å†é€¼é€¼å‡ å¥

è¿™æ˜¯æˆ‘ç†è§£ä¸­çš„â€œè„šæ‰‹æ¶â€ï¼Œå¸Œæœ›å…¶ä»–å°ä¼™ä¼´ä¹Ÿè¯„è®ºä¸€ä¸‹è‡ªå·±ç†è§£çš„è„šæ‰‹æ¶ã€‚

ğŸ˜¢ å·²ç»è¿‘ä¸€å¹´æ²¡æœ‰åšè¿‡æŠ€æœ¯åˆ†äº«äº†ï¼Œæ¯å¤©åœ¨æ˜é‡‘é‡Œæ½œæ°´ï¼Œå¶å°”å‘ç‚¹æ²¸ç‚¹ï¼Œä¸æ•¢åœ¨é¦–é¡µå‘å†…å®¹ï¼Œæ€»è§‰å¾—è‡ªå·±æŠ€æœ¯ä¸è¶³ï¼Œæ€•å¤§ä½¬å–·ï¼Œè‡ªå°Šå¿ƒå—åˆ°åˆ›ä¼¤ã€‚

æœ€ååˆ†äº«ä¸€ä¸‹æˆ‘çš„â€œè„šæ‰‹æ¶â€ï¼Œè¿™ä¸ªé¡¹ç›®åœ¨æˆ‘é¢è¯•ä¸­ä¹Ÿèµ·åˆ°äº†ä¸é”™çš„æ•ˆæœï¼š

æ–‡æ¡£ï¼šhttps://codexu.github.io/