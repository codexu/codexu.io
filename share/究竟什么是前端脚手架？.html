<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>究竟什么是前端脚手架？ | X-BUILD</title>
    <meta name="description" content="">
    
    
    <link rel="preload" href="/assets/css/0.styles.859a2b70.css" as="style"><link rel="preload" href="/assets/js/app.d8e8e414.js" as="script"><link rel="preload" href="/assets/js/2.4f310d24.js" as="script"><link rel="preload" href="/assets/js/19.88ddee67.js" as="script"><link rel="prefetch" href="/assets/js/10.192e02b0.js"><link rel="prefetch" href="/assets/js/11.f9214cfd.js"><link rel="prefetch" href="/assets/js/12.c2eedbbc.js"><link rel="prefetch" href="/assets/js/13.10abc902.js"><link rel="prefetch" href="/assets/js/14.7afa5dc9.js"><link rel="prefetch" href="/assets/js/15.e4a1cd52.js"><link rel="prefetch" href="/assets/js/16.9166d4b2.js"><link rel="prefetch" href="/assets/js/17.ebcc5ac1.js"><link rel="prefetch" href="/assets/js/18.355857b0.js"><link rel="prefetch" href="/assets/js/20.c730628b.js"><link rel="prefetch" href="/assets/js/21.86fa485e.js"><link rel="prefetch" href="/assets/js/22.2e10ac92.js"><link rel="prefetch" href="/assets/js/23.82951de6.js"><link rel="prefetch" href="/assets/js/24.cead7a62.js"><link rel="prefetch" href="/assets/js/25.06d598ae.js"><link rel="prefetch" href="/assets/js/26.a479499d.js"><link rel="prefetch" href="/assets/js/27.8822658b.js"><link rel="prefetch" href="/assets/js/28.3a36513b.js"><link rel="prefetch" href="/assets/js/29.ea50a4c3.js"><link rel="prefetch" href="/assets/js/3.f0afd4d3.js"><link rel="prefetch" href="/assets/js/30.56dd4442.js"><link rel="prefetch" href="/assets/js/31.de1d0d27.js"><link rel="prefetch" href="/assets/js/32.f29f594a.js"><link rel="prefetch" href="/assets/js/33.cc2e9e3e.js"><link rel="prefetch" href="/assets/js/34.f62ff633.js"><link rel="prefetch" href="/assets/js/35.e03987af.js"><link rel="prefetch" href="/assets/js/36.6004732e.js"><link rel="prefetch" href="/assets/js/37.d5bf2c46.js"><link rel="prefetch" href="/assets/js/38.942321d9.js"><link rel="prefetch" href="/assets/js/39.6369d8b6.js"><link rel="prefetch" href="/assets/js/4.2ca7c99c.js"><link rel="prefetch" href="/assets/js/40.5b0472d7.js"><link rel="prefetch" href="/assets/js/41.0bbde06c.js"><link rel="prefetch" href="/assets/js/42.7a6b1c0a.js"><link rel="prefetch" href="/assets/js/5.612f1155.js"><link rel="prefetch" href="/assets/js/6.c66491f5.js"><link rel="prefetch" href="/assets/js/7.921dde6d.js"><link rel="prefetch" href="/assets/js/8.932fae18.js"><link rel="prefetch" href="/assets/js/9.284a29d4.js">
    <link rel="stylesheet" href="/assets/css/0.styles.859a2b70.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">X-BUILD</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">Get started</a></div><div class="nav-item"><a href="/concept.html" class="nav-link">Guide</a></div><div class="nav-item"><a href="/utils/get_started_quickly.html" class="nav-link">Tools</a></div><div class="nav-item"><a href="/case/" class="nav-link">Cases</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">Languages</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/share/究竟什么是前端脚手架？.html" class="nav-link">English</a></li><li class="dropdown-item"><!----> <a href="/zh/" class="nav-link">简体中文</a></li></ul></div></div> <a href="https://github.com/codexu/x-build" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">Get started</a></div><div class="nav-item"><a href="/concept.html" class="nav-link">Guide</a></div><div class="nav-item"><a href="/utils/get_started_quickly.html" class="nav-link">Tools</a></div><div class="nav-item"><a href="/case/" class="nav-link">Cases</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">Languages</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/share/究竟什么是前端脚手架？.html" class="nav-link">English</a></li><li class="dropdown-item"><!----> <a href="/zh/" class="nav-link">简体中文</a></li></ul></div></div> <a href="https://github.com/codexu/x-build" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>Get started</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/" class="sidebar-link">Overview</a></li><li><a href="/cli.html" class="sidebar-link">CLI</a></li><li><a href="/quick_start.html" class="sidebar-link">Quick start</a></li><li><a href="/create_project.html" class="sidebar-link">Create project</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Guide</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/concept.html" class="sidebar-link">Concept</a></li><li><a href="/configuration.html" class="sidebar-link">Configuration</a></li><li><a href="/StateManagement.html" class="sidebar-link">State Management</a></li><li><a href="/specification.html" class="sidebar-link">Specification</a></li><li><a href="/Testing.html" class="sidebar-link">Testing</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Tools</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/utils/get_started_quickly.html" class="sidebar-link">Get started quickly</a></li><li><a href="/utils/x-fullpage.html" class="sidebar-link">Fullpage</a></li><li><a href="/utils/x-load.html" class="sidebar-link">Load</a></li><li><a href="/utils/x-animate.html" class="sidebar-link">Animate</a></li><li><a href="/utils/x-touch.html" class="sidebar-link">Touch</a></li><li><a href="/utils/x-music.html" class="sidebar-link">Music</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="究竟什么是前端脚手架？"><a href="#究竟什么是前端脚手架？" aria-hidden="true" class="header-anchor">#</a> 究竟什么是前端脚手架？</h1> <p>😔 咱也不知道咱也不敢问啊</p> <p>先查查百度百科里对“脚手架”的定义吧：</p> <blockquote><p>脚手架是为了保证各施工过程顺利进行而搭设的工作平台。</p></blockquote> <p>然后搜一下“脚手架”，基本上都是以下几类：</p> <ul><li><p>Vue/React 脚手架</p></li> <li><p>使用 Node、yeoman 打造自己的脚手架</p></li> <li><p>从零搭建 webpack 脚手架</p></li></ul> <p>此时还是无法确定什么是“脚手架”，也许我心目中的脚手架应该是 vue/cli 或者 create-react-app 吧，然后我打开他们的文档，但是他们的介绍上并没有说这是一款脚手架...</p> <h2 id="谈一下我自己的“脚手架”"><a href="#谈一下我自己的“脚手架”" aria-hidden="true" class="header-anchor">#</a> 谈一下我自己的“脚手架”</h2> <p>😔 我最怕别人看到我的“脚手架”后说这有什么卵用...</p> <p>看了一下我第一次在 Github 上的提交记录 Commits on Feb 13, 2017，我入行三年多，那时应该是我第一次进入前端工程化的时候吧。在此之前我在公司接手的都是一些很简单的项目，直接新建文件夹，随手下载一个jQuery，然后新建 index.html main.js style.css，有没有同样经历的小伙伴们？</p> <p>后来做的项目多了，觉得每次这么新建项目太麻烦，我新建了一个文件夹，专门存放初始的模板，然后复制粘贴，继续撸。</p> <p>再后来，接触到 vue，他可以实现在终端内输入一行指令就能生成模板，这可比我复制粘贴看起来高端多了，为了装逼我开始了研究如何开发自己的“脚手架”。</p> <p>当时还真是没有几篇文章把这种操作说的很明白，甚至我并不知道我要做的东西叫什么（脚手架）。</p> <h2 id="我理解的“脚手架”"><a href="#我理解的“脚手架”" aria-hidden="true" class="header-anchor">#</a> 我理解的“脚手架”</h2> <p>🤓 百科里说的很对我的思路，首要的就是保证我的项目可以顺利进行。</p> <ul><li><p>能够快速帮我生成新项目的目录模板(Node.js)。</p></li> <li><p>能够提升我的开发效率和开发的舒适性(webpack)。</p></li></ul> <h2 id="分享点干货"><a href="#分享点干货" aria-hidden="true" class="header-anchor">#</a> 分享点干货</h2> <p>从零搭建这种我就不说了，毕竟一搜一堆，基本上就是推荐几个库，例如 commander、inquirer、ora 等等。分享一些在我的脚手架开发时遇到的一些问题和需求，分享想给大家。</p> <h3 id="版本验证"><a href="#版本验证" aria-hidden="true" class="header-anchor">#</a> 版本验证</h3> <p>首先推荐工具库：</p> <p><a href="https://www.npmjs.com/package/semver" target="_blank" rel="noopener noreferrer">semver<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>，版本对比。</p> <p><a href="https://www.npmjs.com/package/semver" target="_blank" rel="noopener noreferrer">request<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>，发送请求，当然你也可以用 axios。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> semver <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'semver'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> request <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'request'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><ul><li>Node.js 版本验证</li></ul> <p>如果你的脚手架想分享给别人用，这步最好不要避免，因为如果你用了一些现代化的 ES 语法，比如说 async await，老版本跑不起来的。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">checkNodeVersion</span> <span class="token punctuation">(</span><span class="token parameter">wanted</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// process.version 可以获取当前的 node 版本</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>semver<span class="token punctuation">.</span><span class="token function">satisfies</span><span class="token punctuation">(</span>process<span class="token punctuation">.</span>version<span class="token punctuation">,</span> wanted<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Node版本不支持巴拉巴拉'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 退出进程</span>
    process<span class="token punctuation">.</span><span class="token function">exit</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><ul><li>脚手架版本验证</li></ul> <p>正如上面所说，你如果分享给别人用，在你修改了一些 bug 后，希望其他人用最新的版本，那就应该提示他。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">checkPackageVersion</span><span class="token punctuation">(</span><span class="token parameter">url</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token function">request</span><span class="token punctuation">(</span>url<span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">error<span class="token punctuation">,</span> response<span class="token punctuation">,</span> body</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>error <span class="token operator">&amp;&amp;</span> response<span class="token punctuation">.</span>statusCode <span class="token operator">===</span> <span class="token number">200</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">let</span> version <span class="token operator">=</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>body<span class="token punctuation">)</span><span class="token punctuation">.</span>version<span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>semver<span class="token punctuation">.</span><span class="token function">lte</span><span class="token punctuation">(</span>version<span class="token punctuation">,</span> requiredVersion<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
          console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'需要更新你的包巴拉巴拉'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
          process<span class="token punctuation">.</span><span class="token function">exit</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'发送请求失败巴拉巴拉'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>参数 url 当然传入 npm 的链接 https://registry.npmjs.org/[你的包名]/latest</p> <h3 id="当前路径下是否存在相同的文件夹"><a href="#当前路径下是否存在相同的文件夹" aria-hidden="true" class="header-anchor">#</a> 当前路径下是否存在相同的文件夹</h3> <p>如果不做这层判断，你新生成的项目很可能会覆盖你已有的项目，别问我为啥想到这么做 😭</p> <div class="language-JavaScript extra-class"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">hasFolder</span><span class="token punctuation">(</span><span class="token parameter">name</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span> <span class="token punctuation">(</span><span class="token parameter">resolve</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    fs<span class="token punctuation">.</span><span class="token function">exists</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span> <span class="token parameter">exists</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>exists<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'已经存在相同目录巴拉巴拉'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        process<span class="token punctuation">.</span><span class="token function">exit</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><p>这里加了一层 Promise 是因为 Node 去检测是否存在文件夹是个异步操作，也需要耗时，这么做比较保险。</p> <h3 id="清空控制台"><a href="#清空控制台" aria-hidden="true" class="header-anchor">#</a> 清空控制台</h3> <p>当你输入完命令后，好像进入了新的页面一样，看起来很舒服。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">clearConsole</span><span class="token punctuation">(</span><span class="token parameter">color<span class="token punctuation">,</span> str</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>process<span class="token punctuation">.</span>stdout<span class="token punctuation">.</span>isTTY <span class="token operator">&amp;&amp;</span> store<span class="token punctuation">.</span>cmd <span class="token operator">!==</span> <span class="token string">'test'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> blank <span class="token operator">=</span> <span class="token string">'\n'</span><span class="token punctuation">.</span><span class="token function">repeat</span><span class="token punctuation">(</span>process<span class="token punctuation">.</span>stdout<span class="token punctuation">.</span>rows<span class="token punctuation">)</span><span class="token punctuation">;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>blank<span class="token punctuation">)</span><span class="token punctuation">;</span>
    readline<span class="token punctuation">.</span><span class="token function">cursorTo</span><span class="token punctuation">(</span>process<span class="token punctuation">.</span>stdout<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    readline<span class="token punctuation">.</span><span class="token function">clearScreenDown</span><span class="token punctuation">(</span>process<span class="token punctuation">.</span>stdout<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="拷贝模板"><a href="#拷贝模板" aria-hidden="true" class="header-anchor">#</a> 拷贝模板</h3> <p>很多关于如果构建脚手架里提到一个工具 download-git-repo，在 github 或其他仓库中下载模板。我并不是很喜欢这种操作，1、耗时，让脚手架构建速度更慢了，在没有网络的情况下无法构建。2、在 git 仓库中还需要新建项目模板，感觉把一个项目分离成了两个，不方便管理。</p> <p>所以我打算直接从全局目录下将模板文件夹拷贝到当前路径下：</p> <p>使用一个工具 <a href="https://www.npmjs.com/package/fs-extra" target="_blank" rel="noopener noreferrer">fs-extra<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>，node.js 新手最好不要试图用原生接口拷贝一个文件夹。</p> <p>const src = path.resolve(__dirname, '../template');</p> <p>const dest = path.resolve(process.cwd(), store.dirname);</p> <p>两个概念：</p> <p>全局环境路径：</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> src <span class="token operator">=</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'你的模板文件夹相对路径'</span>）
</code></pre></div><p>当前环境路径：</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> dest <span class="token operator">=</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>process<span class="token punctuation">.</span><span class="token function">cwd</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'你创建项目的名称'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><div class="language-javascript extra-class"><pre class="language-javascript"><code>  fs<span class="token punctuation">.</span><span class="token function">copy</span><span class="token punctuation">(</span>src<span class="token punctuation">,</span> dest<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token comment">/* 巴拉巴拉 */</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="自动选择包管理器"><a href="#自动选择包管理器" aria-hidden="true" class="header-anchor">#</a> 自动选择包管理器</h3> <p>现在用 yarn 的人越来越多，而且确实效率很高，如果安装过 yarn 就让它作为默认包管理器去自动安装依赖吧。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">packageManagement</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">try</span> <span class="token punctuation">{</span>
    child_process<span class="token punctuation">.</span><span class="token function">execSync</span><span class="token punctuation">(</span><span class="token string">'yarnpkg --version'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> stdio<span class="token punctuation">:</span> <span class="token string">'ignore'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token string">'yarn'</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token string">'npm'</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="自动安装依赖"><a href="#自动安装依赖" aria-hidden="true" class="header-anchor">#</a> 自动安装依赖</h3> <p>这里用到 Node.js 中的 <a href="http://nodejs.cn/api/child_process.html#child_process_child_process_spawn_command_args_options" target="_blank" rel="noopener noreferrer">child_process.spawn<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> 方法</p> <p>这里举个例子，想要执行 npm install webpack -D</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> ls <span class="token operator">=</span> <span class="token function">spawn</span><span class="token punctuation">(</span><span class="token string">'npm'</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">'isntall'</span><span class="token punctuation">,</span> <span class="token string">'webpack'</span><span class="token punctuation">,</span> <span class="token string">'-D'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>shell<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
ls<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'close'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">code</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token comment">/* 巴拉巴拉 */</span><span class="token punctuation">)</span>
</code></pre></div><ul><li><p>第一个参数：要运行的命令。</p></li> <li><p>第二个参数：数组，字符串参数的列表。</p></li> <li><p>第三个参数：配置，这里把 shell 设置为 true。</p></li> <li><p>使用 on 方法监听执行结果。</p></li></ul> <blockquote><p>这里推荐安装的包带有版本号，如果直接安装会安装最新版，可能会导致不兼容。</p></blockquote> <h3 id="提一个-webpack-的插件"><a href="#提一个-webpack-的插件" aria-hidden="true" class="header-anchor">#</a> 提一个 webpack 的插件</h3> <p><a href="https://webpack.docschina.org/plugins/progress-plugin/#src/components/Sidebar/Sidebar.jsx" target="_blank" rel="noopener noreferrer">ProgressPlugin<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>，用于监听编译进度。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>plugins<span class="token punctuation">:</span> <span class="token punctuation">[</span>
  <span class="token keyword">new</span> <span class="token class-name">webpack<span class="token punctuation">.</span>ProgressPlugin</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">percentage</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// percentage 进度 0-1</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">]</span>
</code></pre></div><p>这里配合前面说到的清空控制台，可以实现更好的体验。</p> <h3 id="使用-ip-访问项目"><a href="#使用-ip-访问项目" aria-hidden="true" class="header-anchor">#</a> 使用 IP 访问项目</h3> <p>这里指的是通过 webpack 启动的 devServer。</p> <p>host 配置为 0.0.0.0</p> <p>通过下面的函数获取到本机的 IP 地址，这样就可以在同网下使用移动设备做测试了。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">getIPAdress</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> interfaces <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'os'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">networkInterfaces</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// eslint-disable-next-line guard-for-in</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> devName <span class="token keyword">in</span> interfaces<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> iface <span class="token operator">=</span> interfaces<span class="token punctuation">[</span>devName<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> iface<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">let</span> alias <span class="token operator">=</span> iface<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>alias<span class="token punctuation">.</span>family <span class="token operator">===</span> <span class="token string">'IPv4'</span> <span class="token operator">&amp;&amp;</span> alias<span class="token punctuation">.</span>address <span class="token operator">!==</span> <span class="token string">'127.0.0.1'</span> <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span>alias<span class="token punctuation">.</span>internal<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> alias<span class="token punctuation">.</span>address<span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="再逼逼几句"><a href="#再逼逼几句" aria-hidden="true" class="header-anchor">#</a> 再逼逼几句</h2> <p>这是我理解中的“脚手架”，希望其他小伙伴也评论一下自己理解的脚手架。</p> <p>😢 已经近一年没有做过技术分享了，每天在掘金里潜水，偶尔发点沸点，不敢在首页发内容，总觉得自己技术不足，怕大佬喷，自尊心受到创伤。</p> <p>最后分享一下我的“脚手架”，这个项目在我面试中也起到了不错的效果：</p> <p>文档：https://codexu.github.io/</p></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/codexu/codexu.github.io/edit/docs/docs/share/究竟什么是前端脚手架？.md" target="_blank" rel="noopener noreferrer">Edit this page on GitHub</a> <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></div> <!----></footer> <!----> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.d8e8e414.js" defer></script><script src="/assets/js/2.4f310d24.js" defer></script><script src="/assets/js/19.88ddee67.js" defer></script>
  </body>
</html>
